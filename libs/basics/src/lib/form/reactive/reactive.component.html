<section>
  <form [formGroup]="signupForm" #form (ngSubmit)="onSubmit()">
    <div formGroupName="userData">
      <div class="form-group">
        <label for="firstname">First Name</label>
        <input type="text" class="form-control" formControlName="firstname" />
        <div
          *ngIf="
            signupForm.get('userData')?.get('firstname')?.invalid &&
            signupForm.get('userData')?.get('firstname')?.errors &&
            (signupForm.get('userData')?.get('firstname')?.dirty || signupForm.get('firstname')?.touched)
          "
        >
          <small class="text-danger" *ngIf="signupForm.get('userData')?.get('firstname')?.hasError('required')">
            This field is required.
          </small>
        </div>
      </div>

      <div class="form-group">
        <label for="lastname">Last Name</label>
        <input type="text" class="form-control" formControlName="lastname" />
      </div>

      <div class="form-group">
        <label for="email">Email</label>
        <input type="email" class="form-control" formControlName="email" />

        <div
          *ngIf="
            signupForm.get('userData')?.get('email')?.invalid &&
            signupForm.get('userData')?.get('email')?.errors &&
            (signupForm.get('userData')?.get('email')?.dirty || signupForm.get('email')?.touched)
          "
        >
          <small class="text-danger" *ngIf="signupForm.get('userData')?.get('email')?.hasError('emailExist')"> Email already exist. </small>
        </div>
      </div>

      <div class="form-group">
        <label for="password">Password</label>
        <input type="password" class="form-control" formControlName="password" />
      </div>

      <div class="form-group">
        <label for="confirmPassword">Confirm Password</label>
        <input type="password" class="form-control" formControlName="confirmPassword" />
      </div>
    </div>

    <div formGroupName="addressData">
      <div class="form-group">
        <label for="city">City</label>
        <input type="text" class="form-control" formControlName="city" />
      </div>

      <div class="form-group">
        <label for="state">State</label>
        <input type="text" class="form-control" formControlName="state" />
      </div>

      <div class="form-group">
        <label for="country">Country</label>
        <input type="text" class="form-control" formControlName="country" />
      </div>
    </div>
    <br />

    <div formArrayName="modules">
      <div class="row" *ngFor="let module of modules.controls; let i = index" [formGroupName]="i">
        <div class="col-md-4">
          <input type="text" class="form-control" formControlName="feature" placeholder="Feature name" />
        </div>

        <div class="col-md-4">
          <input type="text" class="form-control" formControlName="plan" placeholder="Plan" />
        </div>

        <div class="col-md-3">
          <input type="text" class="form-control" formControlName="price" placeholder="Price" />
        </div>

        <div class="col col-md-1">
          <button type="button" class="btn btn-secondary" (click)="removeModule(i)">remove</button>
        </div>
        <br /><br />
      </div>
      <br />
    </div>

    <br />

    <div>
      <button class="btn btn-primary" (click)="createModule()">New module</button>
    </div>

    <br />

    <div class="flex">
      <button type="submit" class="btn btn-primary" [disabled]="signupForm.invalid">Submit</button>
    </div>
  </form>
</section>
